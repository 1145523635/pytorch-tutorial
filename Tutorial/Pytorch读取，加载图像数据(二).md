# Pytorch读取，加载图像数据(二)

在学习Pytorch的时候，先学会如何正确创建或者加载数据，至关重要。

有了数据，很多函数，操作的效果就变得很直观。

**本文主要用Pytorch的`Dataset`**

## 零：准备

加载数据前，需要掌握正确的读取路径方法。很多教程中的例子，在讲解的时候，没有提供图片，或者读者不知道如何修改教程中的读取路径，打击了热情。

**建议：为了保证大家可以跟着教程一步一步练习，教程中会出现示例图片，建议大家右键-另存为图片，将图片保存到 你运行程序的文件夹 中。**

如下图：

![001](E:/%E6%96%87%E6%A1%A3/GitHub/Pytorch-Tutorial/imgs/001.png)

## 壹：数据集的准备

任务：我们用不同的方式读取这两张图片（记得右键-另存为图片，保存到程序所在位置，记得文件重命名为你喜欢的方式，我的重命名为`002.jpg`和`003.jpg`

![002](E:/%E6%96%87%E6%A1%A3/GitHub/Pytorch-Tutorial/imgs/002.jpg)

![003](E:/%E6%96%87%E6%A1%A3/GitHub/Pytorch-Tutorial/imgs/003.jpg)

将文件另存为后，同时新建一个python文件，我的效果如下：

![004](E:/%E6%96%87%E6%A1%A3/GitHub/Pytorch-Tutorial/imgs/004.png)

接下来，我们就可以在`load_images.py`中，进行相关操作了。

## 壹：加载图像流程

我们先从上而下，看下加载图像的流程。通过这种可是，可以对Pytorch中的这些类有个大概的了解，知道它们出现的必要性，以及作用。



## 贰：`DataSet`

`Dataset`是一个抽象类，如果想要创建自己的数据集的话，或者说，想要用`Pytorch`的库来进入数据加载的话，是需要继承这个`Dataset`抽象类的。同时需要重写这个类的函数。

**我们先来想想：一个数据集需要具备哪些功能？**

* 明确找到或加载所需要的数据（这就需要我们提供数据的地址）
* 如果是有标记的数据，还需要将数据与标记对应起来

**还有一点，我们需要能找到某一个数据**。这样做有什么用处呢？

这样一来可以检验数据，或者评估模型的性能。更重要的是，因为机器学习的数据量很大，很难将所有的数据一次性加载到内存中。所以需要分批进入，把这些数据分组，每组，就是我们常说的`batch`。既然要分组，就需要能找到对应的数据。

就像我们考试的时候，每个人有个编号。1-10坐第一列，11-20坐第二列。

继承`Dataset`的子类，需要重写`__len__()`与`__getitem__`。在实际的情况中，我们还需要写`__init__()`。

要想实现第一个功能，一般情况会在`__init__()`中实现，比如指定路径。

要想实现第二个，第三个功能，一般情况会在`__getitem__()`中实现，一般会返回`label`和`img`

那么`__len__()`有什么用呢？

